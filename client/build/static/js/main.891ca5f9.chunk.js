(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{144:function(e,t,n){},145:function(e,t,n){},244:function(e,t,n){},245:function(e,t,n){},246:function(e,t,n){},247:function(e,t,n){},248:function(e,t,n){},249:function(e,t,n){},250:function(e,t,n){},251:function(e,t,n){},254:function(e,t,n){},255:function(e,t,n){},256:function(e,t,n){},257:function(e,t,n){},258:function(e,t,n){},259:function(e,t,n){},260:function(e,t,n){},261:function(e,t,n){},396:function(e,t,n){},397:function(e,t,n){},398:function(e,t,n){},399:function(e,t,n){},400:function(e,t,n){},401:function(e,t,n){},402:function(e,t,n){"use strict";n.r(t);var a=n(2),c=n(1),r=n.n(c),l=n(193),s=n.n(l),i=n(24),o=n(430),u=(n(244),n(6)),d=n(14),j=n(18),b=n(4),m=n(194),f=n.n(m);n(245),n(246);function h(e){var t=e.title,n=e.size,c=e.position,l=e.children,s=e.stickToEnd,i=e.zIndex,o=e.fontSize,u=r.a.Children.toArray(l).map((function(e,t){return Object(a.jsx)("div",{className:"navbar_child",children:e},t)})),d=u.slice(0,u.length-s),j=u.slice(u.length-s),m=n&&"vertical"===c?{width:n}:{height:n},f=o?{fontSize:o}:{};return Object(a.jsxs)("div",{style:Object(b.a)(Object(b.a)({},m),{},{zIndex:i}),className:"navbar navbar__".concat(c),children:[Object(a.jsxs)("div",{className:"navbar_header",children:[Object(a.jsx)("div",{className:"navbar_title",style:f,children:t}),Object(a.jsx)("div",{className:"navbar_divider"})]}),Object(a.jsxs)("div",{className:"navbar_body",children:[Object(a.jsx)("div",{className:"navbar_children",children:d}),Object(a.jsx)("div",{className:"navbar_children__end",children:j})]})]})}h.defaultProps={position:"vertical",stickToEnd:0,title:"Navbar",zIndex:null};var p=h;n(247);function O(){return(O=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var a in n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a])}return e}).apply(this,arguments)}function v(e,t){if(null==e)return{};var n,a,c=function(e,t){if(null==e)return{};var n,a,c={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(c[n]=e[n]);return c}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(c[n]=e[n])}return c}var x=c.createElement("path",{d:"M85.365 43.085H81.535H77.676H73.846H69.986H66.156H62.296V46.945H66.156H69.986H73.846H77.676H81.535H85.365H89.226V43.085H85.365Z",fill:"#9EABA5"}),g=c.createElement("path",{d:"M81.535 77.705H77.676V81.535H81.535V77.705Z",fill:"#9EABA5"}),_=c.createElement("path",{d:"M81.535 8.465H77.676V12.325H81.535V8.465Z",fill:"#9EABA5"}),y=c.createElement("path",{d:"M77.676 73.846H73.846V77.705H77.676V73.846Z",fill:"#9EABA5"}),E=c.createElement("path",{d:"M77.676 12.325H73.846V16.155H77.676V12.325Z",fill:"#9EABA5"}),N=c.createElement("path",{d:"M73.845 70.016H69.986V73.846H73.845V70.016Z",fill:"#9EABA5"}),A=c.createElement("path",{d:"M73.845 16.155H69.986V20.015H73.845V16.155Z",fill:"#9EABA5"}),V=c.createElement("path",{d:"M69.986 66.154H66.156V70.015H69.986V66.154Z",fill:"#9EABA5"}),k=c.createElement("path",{d:"M69.986 20.015H66.156V23.845H69.986V20.015Z",fill:"#9EABA5"}),S=c.createElement("path",{d:"M66.156 62.324H62.296V66.154H66.156V62.324Z",fill:"#9EABA5"}),w=c.createElement("path",{d:"M66.156 23.845H62.296V27.705H66.156V23.845Z",fill:"#9EABA5"}),H=c.createElement("path",{d:"M62.296 58.465H58.466V62.324H62.296V58.465Z",fill:"#9EABA5"}),T=c.createElement("path",{d:"M62.296 27.705H58.466V31.535H62.296V27.705Z",fill:"#9EABA5"}),C=c.createElement("path",{d:"M43.056 66.154V70.016V73.846V77.705V81.535V85.395V89.225H46.916V85.395V81.535V77.705V73.846V70.016V66.154V62.324H43.056V66.154Z",fill:"#9EABA5"}),L=c.createElement("path",{d:"M43.056 4.635V8.465V12.325V16.155V20.015V23.845V27.705H46.916V23.845V20.015V16.155V12.325V8.465V4.635V0.775002H43.056V4.635Z",fill:"#9EABA5"}),M=c.createElement("path",{d:"M31.535 58.465H27.676V62.324H31.535V58.465Z",fill:"#9EABA5"}),R=c.createElement("path",{d:"M31.535 27.705H27.676V31.535H31.535V27.705Z",fill:"#9EABA5"}),B=c.createElement("path",{d:"M27.676 62.324H23.846V66.154H27.676V62.324Z",fill:"#9EABA5"}),P=c.createElement("path",{d:"M27.676 23.845H23.846V27.705H27.676V23.845Z",fill:"#9EABA5"}),I=c.createElement("path",{d:"M23.845 66.154H19.986V70.015H23.845V66.154Z",fill:"#9EABA5"}),D=c.createElement("path",{d:"M23.845 20.015H19.986V23.845H23.845V20.015Z",fill:"#9EABA5"}),z=c.createElement("path",{d:"M19.986 70.016H16.156V73.846H19.986V70.016Z",fill:"#9EABA5"}),U=c.createElement("path",{d:"M19.986 16.155H16.156V20.015H19.986V16.155Z",fill:"#9EABA5"}),q=c.createElement("path",{d:"M16.156 73.846H12.296V77.705H16.156V73.846Z",fill:"#9EABA5"}),Z=c.createElement("path",{d:"M16.156 12.325H12.296V16.155H16.156V12.325Z",fill:"#9EABA5"}),F=c.createElement("path",{d:"M12.296 77.705H8.466V81.535H12.296V77.705Z",fill:"#9EABA5"}),G=c.createElement("path",{d:"M12.296 46.945H16.156H19.986H23.846H27.676V43.085H23.846H19.986H16.156H12.296H8.46599H4.60499H0.774994V46.945H4.60499H8.46599H12.296Z",fill:"#9EABA5"}),W=c.createElement("path",{d:"M12.296 8.465H8.466V12.325H12.296V8.465Z",fill:"#9EABA5"});function J(e,t){var n=e.title,a=e.titleId,r=v(e,["title","titleId"]);return c.createElement("svg",O({width:90,height:90,viewBox:"0 0 90 90",fill:"none",ref:t,"aria-labelledby":a},r),n?c.createElement("title",{id:a},n):null,x,g,_,y,E,N,A,V,k,S,w,H,T,C,L,M,R,B,P,I,D,z,U,q,Z,F,G,W)}var Y=c.forwardRef(J);n.p;function K(e){var t=e.title,n=e.width,c=e.blank,r=e.children,l=e.className,s=e.style,i=e.empty,o=e.emptyText,u=c?" window__blank":"",d=Object(a.jsxs)("div",{className:"window window__empty "+l,style:Object(b.a)({width:n},s),children:[t&&Object(a.jsx)("div",{className:"window_title",children:Object(a.jsx)("h2",{children:t})}),Object(a.jsxs)("div",{className:"window_body",children:[Object(a.jsx)("div",{className:"window__empty-icon",children:Object(a.jsx)(Y,{})}),Object(a.jsx)("div",{className:"window__empty-text",children:o.split("\\").map((function(e){return Object(a.jsxs)(a.Fragment,{children:[e,Object(a.jsx)("br",{})]})}))})]})]});return i?d:Object(a.jsxs)("div",{className:"window"+u+" "+l,style:Object(b.a)({width:n},s),children:[!c&&t&&Object(a.jsx)("div",{className:"window_title",children:Object(a.jsx)("h2",{children:t})}),Object(a.jsx)("div",{className:"window_body",children:r})]})}K.defaultProps={blank:!1,style:{},empty:!1,emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.",className:""};var X=K,$=(n(248),{form:" form-button",corner:" corner-button"});function Q(e){var t=e.type,n=e.corner,c=e.submit,r=e.text,l=e.onClick,s=e.disabled,i=e.color,o=(e.formHeight,e.className),u=e.style,d=$[t]+"_btn__"+i,j=n?"__"+n:"",b=n?$[t]+"_btn"+j:"",m=c?Object(a.jsx)("input",{className:o+$[t]+"_btn"+d+b,disabled:s,onClick:l,type:"submit",value:r,style:u}):Object(a.jsx)("button",{className:o+$[t]+"_btn"+d+b,disabled:s,onClick:l,style:u,children:r});return Object(a.jsx)("div",{className:$[t]+$[t]+j,children:m})}Q.defaultProps={type:"form",submit:!1,corner:"",text:"",disabled:!1,color:"green",className:""};var ee=Q;n(249);function te(e){var t=e.content,n=e.cols,c=e.header,r=e.boldRows,l=e.centeredCols,s=c?Object(a.jsx)("thead",{className:"table_thead",children:Object(a.jsx)("tr",{children:c.map((function(e){return Object(a.jsx)("th",{children:e})}))})}):"",i=Object(a.jsx)("tbody",{className:"table_tbody",children:t.map((function(e,t){return Object(a.jsx)("tr",{children:e.map((function(e,c){var s=n&&n[c]?"!"===n[c][0]?{width:n[c].slice(1)+"px"}:{minWidth:n[c]+"px"}:{},i=l.includes(c)?{textAlign:"center"}:{};return Object(a.jsx)("td",{style:Object(b.a)(Object(b.a)({},s),i),className:r.includes(t)?"table_td__bold":"",children:isNaN(e)?e:Number(e).toFixed(1)})}))})}))});return Object(a.jsx)("div",{className:"table",children:Object(a.jsxs)("table",{className:"table-tag",children:[s,i]})})}te.defaultProps={content:[],boldRows:[],centeredCols:[]};var ne=te,ae=(n(250),n(251),{dots:" data-table_field-leader__dots",centeredDots:" data-table_field-leader__centered-dots",none:""}),ce={small:" data-table__small",normal:"",large:" data-table__large"};function re(e){e.name;var t=e.fields,n=e.size,c=e.leader,r=(e.separator,e.colorScheme,t.map((function(e,t){return Object(a.jsxs)("li",{className:"data-table_field",children:[Object(a.jsx)("div",{className:"data-table_field-name",children:e.label||e.name}),Object(a.jsx)("div",{className:"data-table_field-leader"+ae[c]}),e.sign?Object(a.jsx)("div",{className:"data-table_field-sign",children:e.sign}):"",Object(a.jsx)("div",{className:"data-table_field-value",children:Number(e.value).toFixed(e.unit.accuracy)}),Object(a.jsx)("div",{className:"data-table_field-unit",children:e.unit.name})]},t)})));return Object(a.jsx)("ul",{className:"data-table"+ce[n],children:r})}re.defaultProps={fields:[],size:"normal",leader:"dots",separator:"none",colorScheme:"main"};var le=re,se={2:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u0423\u0436\u0438\u043d"],3:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041e\u0431\u0435\u0434","\u0423\u0436\u0438\u043d"],4:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u0423\u0436\u0438\u043d"],5:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d"],6:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d","\u041f\u0435\u0440\u0435\u043a\u0443\u0441"],7:["\u0417\u0430\u0432\u0442\u0440\u0430\u043a","\u0412\u0442\u043e\u0440\u043e\u0439 \u0437\u0430\u0432\u0442\u0440\u0430\u043a","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u041e\u0431\u0435\u0434","\u041f\u0435\u0440\u0435\u043a\u0443\u0441","\u0423\u0436\u0438\u043d","\u041f\u0435\u0440\u0435\u043a\u0443\u0441"]},ie=["\u041f\u0440\u043e\u0434\u0443\u043a\u0442","\u041f\u043e\u0440\u0446\u0438\u044f","\u0411","\u0416","\u0423","\u042d\u043d\u0435\u0440\u0433\u0438\u044f"];function oe(e){var t=e.plan,n=se[t.length],c=t.map((function(e,t){return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("h2",{children:n&&n[t]}),Object(a.jsx)("div",{className:"meal-plan_meal-table",children:Object(a.jsx)(ne,{content:e,header:t?null:ie,boldRows:[e.length-1],centeredCols:[1,2,3,4,5],cols:["!230",65,40,40,40,70]})})]})}));return Object(a.jsx)("div",{className:"meal-plan",children:c})}oe.defaultProps={plan:[[],[],[]]};var ue=oe,de=n(143),je=function(e){localStorage.setItem("access_token",e.access),localStorage.setItem("refresh_token",e.refresh),console.log("Saved access and refresh tokens to local storage",e.access,e.refresh)},be=function(){var e={refresh:localStorage.getItem("refresh_token")};if(!e)throw{data:"No refresh token",status:400,logout:!0};return fetch("/api/auth/refresh_token/",{method:"POST",body:JSON.stringify(e),headers:{"Content-Type":"application/json"}}).then((function(e){return e.json().then((function(t){return new Promise((function(n,a){e.ok?(je(t),n({data:t,status:e.status})):400===e.status||401===e.status?a({status:e.status,data:"Could not refresh token",logout:!0}):a({status:e.status,data:"Could not refresh token"})}))}))}))},me=function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"POST",a="POST"===n,c=function(e){return{method:n,headers:{Authorization:"Bearer "+e}}},r=function(t){return{method:n,headers:{Authorization:"Bearer "+t,"Content-Type":"application/json"},body:JSON.stringify(e)}};return console.log("401 Unauthorized: ".concat(t)),be().then((function(e){return console.log("Retrying ".concat(t,". Refresh tokens: "),e,e.status),new Promise((function(t){t(e.status)}))})).then((function(e){var n=localStorage.getItem("access_token");return console.log("Sending 2nd req"),fetch(t,a?r(n):c(n))})).then((function(e){return e.json().then((function(t){return new Promise((function(n,a){e.ok?n({data:t,status:e.status}):a({status:e.status,data:"2nd attempt failed",logout:!0})}))}))}))},fe={portion:{label:"\u041c\u0430\u0441\u0441\u0430",unit:{accuracy:.01,name:"\u0433"}},protein:{label:"\u0411\u0435\u043b\u043a\u0438",unit:{accuracy:.01,name:"\u0433"}},fat:{label:"\u0416\u0438\u0440\u044b",unit:{accuracy:.01,name:"\u0433"}},carbohydrate:{label:"\u0423\u0433\u043b\u0435\u0432\u043e\u0434\u044b",unit:{accuracy:.01,name:"\u0433"}},energy:{label:"\u042d\u043d\u0435\u0440\u0433\u0435\u0442\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c",unit:{accuracy:.01,name:"\u043a\u043a\u0430\u043b"}},water:{label:"\u0412\u043e\u0434\u0430",unit:{accuracy:.01,name:"\u043c\u043b"}},sfa:{label:"\u041d\u0430\u0441\u044b\u0449\u0435\u043d\u043d\u044b\u0435 \u0436\u0438\u0440\u043d\u044b\u0435 \u043a\u0438\u0441\u043b\u043e\u0442\u044b",unit:{accuracy:.01,name:"\u0433"}},mds:{label:"\u041c\u043e\u043d\u043e- \u0438 \u0434\u0438\u0441\u0430\u0445\u0430\u0440\u0438\u0434\u044b",unit:{accuracy:.01,name:"\u0433"}},starch:{label:"\u041a\u0440\u0430\u0445\u043c\u0430\u043b",unit:{accuracy:.01,name:"\u0433"}},fiber:{label:"\u041f\u0438\u0449\u0435\u0432\u044b\u0435 \u0432\u043e\u043b\u043e\u043a\u043d\u0430",unit:{accuracy:.01,name:"\u0433"}},sodium:{label:"\u041d\u0430\u0442\u0440\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},potassium:{label:"\u041a\u0430\u043b\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},calcium:{label:"\u041a\u0430\u043b\u044c\u0446\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},magnesium:{label:"\u041c\u0430\u0433\u043d\u0438\u0439",unit:{accuracy:.01,name:"\u043c\u0433"}},phosphorus:{label:"\u0424\u043e\u0441\u0444\u043e\u0440",unit:{accuracy:.01,name:"\u043c\u0433"}},iron:{label:"\u0416\u0435\u043b\u0435\u0437\u043e",unit:{accuracy:.01,name:"\u043c\u0433"}},thiamine:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B1",unit:{accuracy:.01,name:"\u043c\u0433"}},riboflavin:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B2",unit:{accuracy:.01,name:"\u043c\u0433"}},niacin:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d PP",unit:{accuracy:.01,name:"\u043c\u0433"}},beta_carotene:{label:"\u0411\u0435\u0442\u0430-\u043a\u0430\u0440\u043e\u0442\u0438\u043d",unit:{accuracy:.01,name:"\xb5\u0433"}},vitamin_c:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d C",unit:{accuracy:.01,name:"\u043c\u0433"}},cholesterol:{label:"\u0425\u043e\u043b\u0435\u0441\u0442\u0435\u0440\u0438\u043d",unit:{accuracy:.01,name:"\u043c\u0433"}},retinol:{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d A",unit:{accuracy:.01,name:"\xb5\u0433"}}},he="/api/get_meal_plans/",pe="/api/generate_meal_plan/",Oe=function(e){return{Authorization:"Bearer "+e}};function ve(e){var t=e.auth,n=e.onAuth,r=e.onPlanRequest,l=e.awaitingNewPlan,s=Object(c.useState)([]),i=Object(u.a)(s,2),o=(i[0],i[1]),d=Object(c.useState)([]),m=Object(u.a)(d,2),h=m[0],O=m[1],v=Object(c.useState)([]),x=Object(u.a)(v,2),g=x[0],_=x[1],y=Object(c.useState)(0),E=Object(u.a)(y,2),N=E[0],A=E[1],V=function(e){var t=["name","categories","source_categories"],n=Object(b.a)({},e),a=n.portions,c=n.size,r=Array(c).fill([]),l=Array(c).fill([]),s={};return a.forEach((function(e){for(var n=e.meal_no-1,a=e.food,c=0,i=Object.entries(a);c<i.length;c++){var o=Object(u.a)(i[c],2),d=o[0],b=o[1];!t.includes(d)&&b&&(d in s?s[d]+=b:s[d]=b)}var m=[a.portion,a.protein,a.fat,a.carbohydrate,a.energy];l[n].length?l[n]=l[n].map((function(e,t){return e+m[t]})):l[n]=m,r[n]=[].concat(Object(j.a)(r[n]),[[a.name].concat(m)])})),s=Object.keys(fe).map((function(e){return Object(b.a)(Object(b.a)({},fe[e]),{},{value:s[e]})})),[r=r.map((function(e,t){return[].concat(Object(j.a)(e),[["\u0418\u0442\u043e\u0433\u043e"].concat(Object(j.a)(l[t]))])})),s]},k=function(){console.log("generating new plan"),fetch(pe,{headers:Oe(localStorage.getItem("access_token"))}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){o((function(t){return[].concat(Object(j.a)(t),[e])}));var t=V(e),n=Object(u.a)(t,2),a=n[0],c=n[1];O((function(e){return[].concat(Object(j.a)(e),[a])})),_((function(e){return[].concat(Object(j.a)(e),[c])}))})).catch((function(e){if(401===e.status)return me(null,pe,"GET").then((function(e){o((function(t){return[].concat(Object(j.a)(t),[e.data])}));var t=V(e.data),n=Object(u.a)(t,2),a=n[0],c=n[1];O((function(e){return[].concat(Object(j.a)(e),[a])})),_((function(e){return[].concat(Object(j.a)(e),[c])})),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&n(!1),console.error("retryRequest error!",e.status,e.data,e)}));console.error(e)}))},S=function(e){var t=h.length;A("next"===e?N<t-1?function(e){return e+1}:0:0===N?t-1:function(e){return e-1})};Object(c.useEffect)((function(){console.log("fetching plans"),fetch(he,{headers:Oe(localStorage.getItem("access_token"))}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){o(e);var t=[],n=[];e.forEach((function(e){var a=V(e),c=Object(u.a)(a,2),r=c[0],l=c[1];t.push(r),n.push(l)})),O(t),_(n)})).catch((function(e){if(console.log("SOME ERROR"),console.log(e),401===e.status)return me(null,he,"GET").then((function(e){o(e);var t=[],n=[];e.forEach((function(e){var a=V(e),c=Object(u.a)(a,2),r=c[0],l=c[1];t.push(r),n.push(l)})),O(t),_(n),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&n(!1),console.error("retryRequest error!",e.status,e.data,e)}))}))}),[t]),Object(c.useEffect)((function(){A(h.length-1),console.log("Change current plan")}),[h]),Object(c.useEffect)((function(){l&&(r(!1),k())}),[l]);return Object(a.jsxs)("div",{className:"meal-plan-page",style:t?{}:{filter:"blur(10px)"},children:[Object(a.jsx)("div",{className:"meal-plan-page_navbar",children:Object(a.jsx)(p,{title:"\u041f\u0438\u0449\u0435\u0432\u0430\u044f \u0446\u0435\u043d\u043d\u043e\u0441\u0442\u044c",size:"350px",fontSize:"24px",children:Object(a.jsx)(le,{fields:g[N]})})}),Object(a.jsx)("div",{className:"meal-plan-page_main-area",children:Object(a.jsxs)("div",{className:"meal-plan-page_container",children:[Object(a.jsx)(X,{width:"700px",blank:!0,className:"meal-plan_header-window",children:Object(a.jsxs)("div",{className:"meal-plan_header",children:[Object(a.jsx)("div",{className:"meal-plan_title",children:Object(a.jsx)("h2",{children:"\u041f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f"})}),Object(a.jsx)("div",{className:"meal-plan_refresh",children:Object(a.jsx)(ee,{type:"corner",corner:"top-right",text:"\u21ba",style:{fontSize:"31px"},onClick:k})}),Object(a.jsxs)("div",{className:"meal-plan_header-body",children:["\u041d\u0430\u0436\u043c\u0438\u0442\u0435 ",Object(a.jsx)("span",{onClick:function(){h.length&&h[N].length&&f.a.toPng(document.querySelector(".meal-plan"),{bgcolor:"#f5f6f6"}).then((function(e){var t=document.createElement("a");t.download="meal-plan.png",t.href=e,t.click()}))},className:"meal-plan_download",children:"\u0441\u044e\u0434\u0430"}),", \u0447\u0442\u043e\u0431\u044b \u0441\u043a\u0430\u0447\u0430\u0442\u044c \u043f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f"]})]})}),Object(a.jsxs)(X,{width:"700px",empty:!h.length,emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.\\\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b.",children:[Object(a.jsxs)("div",{className:"meal-plan_select-buttons",children:[Object(a.jsx)("div",{className:"meal-plan_prev-button",onClick:function(){return S("prev")},children:"\u2190"}),Object(a.jsx)("div",{className:"meal-plan_next-button",onClick:function(){return S("next")},children:"\u2192"})]}),Object(a.jsx)(ue,{plan:h[N]})]})]})})]})}ve.defaultProps={};var xe=ve,ge=(n(254),n(144),n(16)),_e=n(428);n(62);function ye(e){e.type;var t=e.value,n=e.name,c=e.label,r=e.disabled,l=e.validityErrors,s=e.onChange,i=e.placeholder,o=e.maxLength,u=e.displayErrors,d=e.subtype,j=0===l.length?"":" input_input-tag__error",b=0===l.length?"":" input_label__error";return Object(a.jsxs)("div",{className:"input",children:[Object(a.jsxs)("label",{className:"input_label-tag",children:[Object(a.jsx)("div",{className:"input_label"+b,children:c}),Object(a.jsx)("input",{className:"input_input-tag"+j,type:d||"text",name:n,value:t,placeholder:i||n,disabled:r,onChange:s,maxLength:o})]}),Object(a.jsx)("ul",{className:"input_validity-errors",children:u&&l.map((function(e,t){return Object(a.jsx)("li",{className:"input_validity-error",children:e},t)}))})]})}ye.defaultProps={type:"text",value:"",name:"Text",disabled:!1};var Ee=ye;n(145);function Ne(e){var t=e.name,n=e.label,c=e.options,r=e.value,l=e.onChange,s=e.validityErrors,i=e.displayErrors,o=0===s.length?"":" radio-group_options__error",u=0===s.length?"":" input_label__error",d=c.map((function(e,n){var c=r===e.name?" radio-group_option__selected":"";return Object(a.jsxs)("label",{className:"radio-group_option"+c,children:[Object(a.jsx)("input",{type:"radio",name:t,value:e.name,checked:r===e.name,onChange:l}),Object(a.jsx)("div",{className:"radio-group_label",children:e.label||e.name})]},n)}));return Object(a.jsxs)("div",{className:"input",children:[Object(a.jsx)("div",{className:"input_label"+u,children:n||t}),Object(a.jsx)("div",{className:"radio-group_options"+o,children:d}),Object(a.jsx)("ul",{className:"input_validity-errors",children:i&&s.map((function(e,t){return Object(a.jsx)("li",{className:"input_validity-error",children:e},t)}))})]})}Ne.defaultProps={options:[],validityErrors:[]};var Ae=Ne;n(255);function Ve(e){var t=e.name,n=e.label,r=e.options,l=e.value,s=e.onChange,i=e.double,o=(e.validityErrors,e.displayErrors,e.dropdownWidth),d=Object(c.useState)(!1),j=Object(u.a)(d,2),b=j[0],m=j[1],f=i?" select__double":"",h=i?" select_dropdown__double":"",p=function(e){var n=e.currentTarget.id;s({currentTarget:{value:n,name:t,type:"select"}})},O=r.filter((function(e){return e.name===l})).map((function(e,t){return Object(a.jsxs)("div",{id:e.name,className:"select_option",children:[Object(a.jsx)("div",{className:"select_option-label",children:e.label}),Object(a.jsx)("div",{className:"select_option-description",children:e.description})]},t)})),v=r.filter((function(e){return e.name!==l})).map((function(e,t){return Object(a.jsxs)("div",{id:e.name,className:"select_option",onClick:p,children:[Object(a.jsx)("div",{className:"select_option-label",children:e.label}),Object(a.jsx)("div",{className:"select_option-description",children:e.description})]},t)})),x=Object(a.jsxs)("div",{className:"select_dropdown"+h,children:[O,v]});return Object(a.jsxs)("div",{className:"input input__select",onClick:function(e){m((function(e){return!e}))},children:[Object(a.jsx)("div",{className:"input_label",children:n}),Object(a.jsx)("div",{className:"select"+f,name:t,children:O}),Object(a.jsx)("div",{className:"select_dropdown-container",style:{width:100*o+"%"},children:b&&x})]})}Ve.defaultProps={dropdownWidth:1};var ke=Ve;n(256);function Se(e){var t=e.name,n=e.label,r=e.options,l=e.value,s=e.onChange,i=(e.double,Object(c.useState)(0)),o=Object(u.a)(i,2),d=o[0],j=o[1];Object(c.useEffect)((function(){j(r.findIndex((function(e){return e.name===l})))}),[l]);return Object(a.jsxs)("div",{className:"input",children:[Object(a.jsx)("div",{className:"input_label",children:n}),Object(a.jsxs)("div",{className:"slider_container",children:[Object(a.jsx)("div",{className:"slider",children:Object(a.jsx)("input",{type:"range",value:d,onChange:function(e){var n=r[e.currentTarget.value].name;s({currentTarget:{value:n,name:t,type:"slider"}})},min:0,max:r.length-1,step:1})}),Object(a.jsxs)("div",{className:"slider_info",children:[r[d]&&r[d].label,Object(a.jsx)("div",{className:"slider_info-detailed",children:r[d]&&r[d].description})]})]})]})}Se.defaultProps={options:[]};var we=Se,He=n(29);n(257);function Te(e){var t=e.name,n=e.label,r=e.options,l=e.value,s=e.onChange,i=e.validityErrors,o=e.displayErrors,d=e.layout,m=e.tooltipWidth,f=Object(c.useState)({}),h=Object(u.a)(f,2),p=h[0],O=h[1],v=0===i.length?"":" radio-group_options__error",x=0===i.length?"":" input_label__error",g=3===d.length?" checkbox-group_options__double":"";Object(c.useEffect)((function(){var e=new ResizeObserver((function(e){var t,n=Object(He.a)(e);try{var a=function(){var e=t.value,n=e.target.dataset.name.split("--").slice(1).join("-");O((function(t){return Object(b.a)(Object(b.a)({},t),{},Object(ge.a)({},n,e.contentRect.width))}))};for(n.s();!(t=n.n()).done;)a()}catch(c){n.e(c)}finally{n.f()}}));document.querySelectorAll('input[type="checkbox"] ~ .radio-group_label').forEach((function(t){e.observe(t)}))}),[]);var _=function(e){var n=new Set(l);e.target.checked?n.add(e.target.name):n.delete(e.target.name),s({currentTarget:{value:Object(j.a)(n),name:t,type:"checkbox"}})};if(1!==d.length&&3!==d.length)throw new Error("layout.length should be 1 or 3");var y=r.map((function(e,n){var c=l&&l.includes(e.name)?" radio-group_option__selected":"",r=e.description?Object(a.jsx)("div",{className:"radio-group_tooltip-container",children:Object(a.jsxs)("div",{style:{minWidth:m},className:"radio-group_tooltip",children:[Object(a.jsx)("div",{className:"radio-group_tooltip-name radio-group_label",style:{width:p[e.name]},children:e.label}),Object(a.jsx)("div",{className:"radio-group_tooltip-description",children:e.description})]})}):"";return Object(a.jsxs)("label",{className:"radio-group_option"+c,children:[Object(a.jsx)("input",{type:"checkbox",name:e.name,checked:!!l&&l.includes(e.name),onChange:_}),Object(a.jsx)("div",{className:"radio-group_label","data-name":t+"--"+e.name,children:e.label||e.name}),r]},n)})),E=d.map((function(e,t){return Object(a.jsx)("div",{className:"checkbox-group_options-row",children:y.splice(0,e)},t)}));return Object(a.jsxs)("div",{className:"input",children:[Object(a.jsx)("div",{className:"input_label"+x,children:n||t}),Object(a.jsx)("div",{className:"radio-group_options checkbox-group_options"+v+g,children:E}),Object(a.jsx)("ul",{className:"input_validity-errors",children:o&&i.map((function(e,t){return Object(a.jsx)("li",{className:"input_validity-error",children:e},t)}))})]})}Te.defaultProps={options:[],validityErrors:[],layout:[5],tooltipWidth:"140px"};var Ce=Te,Le=Ee,Me=(n(258),{0:"\u041f\u043e\u043b\u0435 \u043d\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0431\u044b\u0442\u044c \u043f\u0443\u0441\u0442\u044b\u043c","1-p":function(e){return"\u041f\u043e\u043b\u0435 \u0434\u043e\u043b\u0436\u043d\u043e \u0441\u043e\u0434\u0435\u0440\u0436\u0430\u0442\u044c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 ".concat(e," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")}}),Re={0:"\u0417\u0430\u043f\u043e\u043b\u043d\u0438\u0442\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u043f\u043e\u043b\u044f","1-p":function(e){return"\u041d\u0435 \u0432\u0441\u0435 \u043f\u043e\u043b\u044f \u0443\u0434\u043e\u0432\u043b\u0435\u0442\u0432\u043e\u0440\u044f\u044e\u0442 \u043c\u0438\u043d\u0438\u043c\u0430\u043b\u044c\u043d\u043e\u043c\u0443 \u043a\u043e\u043b\u0438\u0447\u0435\u0441\u0442\u0432\u0443 \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"}},Be={401:"\u041f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f \u0441 \u0442\u0430\u043a\u0438\u043c\u0438 \u0434\u0430\u043d\u043d\u044b\u043c\u0438 \u043d\u0435 \u0441\u0443\u0449\u0435\u0441\u0442\u0432\u0443\u0435\u0442"};function Pe(e){var t=e.fields,n=e.formTitle,r=(e.submitText,e.submitUrl),l=e.singleErrorList,s=e.columns,i=e.sections,o=e.width,d=e.dataToSend,j=e.headers,m=e.withAuth,f=e.onResponse,h=e.errorsToDisplay,p=e.onFieldChange,O=Object(_e.a)(),v=Object(u.a)(O,2),x=v[0],g=(v[1],Object(c.useState)({})),_=Object(u.a)(g,2),y=_[0],E=_[1],N=Object(c.useState)({}),A=Object(u.a)(N,2),V=A[0],k=A[1],S=t.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},t.name,RegExp(t.regex)||/[\s\S]*/))}),{}),w=t.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},t.name,!!t.required))}),{}),H=t.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},t.name,t.minLength||0))}),{});Object(c.useEffect)((function(){var e=t.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},t.name,t.initialValue||""))}),{}),n=t.reduce((function(e,t){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},t.name,{}))}),{});E(e),k(n)}),[t]);var T=function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;k((function(c){return Object(b.a)(Object(b.a)({},c),{},Object(ge.a)({},e,Object(b.a)(Object(b.a)({},c[e]),{},Object(ge.a)({},t,[n,a]))))}))},C=function(e,t){var n=""===t&&w[e];return T(e,0,n),!n},L=function(e){var t,n,a=e.currentTarget;"radio"===a.type||"checkbox"===a.type?(C(a.name,a.value),p(a.name,a.value),E((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},a.name,a.value))}))):(t=a.name,(""===(n=a.value)||S[t].test(n))&&(C(a.name,a.value),function(e,t){if(!H[e])return!0;var n=0!==t.length&&t.length<H[e];T(e,"1-p",n,H[e])}(a.name,a.value),p(a.name,a.value),E((function(e){return Object(b.a)(Object(b.a)({},e),{},Object(ge.a)({},a.name,a.value))}))))},M=[],R=t.map((function(e,t){var n=V[e.name]||{},a=l?Object.keys(n).filter((function(e){return n[e][0]})).map((function(e){return e.includes("-p")?Re[e](n[e][1]):Re[e]})):Object.keys(n).filter((function(e){return n[e][0]})).map((function(e){return e.includes("-p")?Me[e](n[e][1]):Me[e]}));return a.forEach((function(e){!M.includes(e)&&M.push(e)})),"radio"===e.type?Object(c.createElement)(Ae,Object(b.a)(Object(b.a)({},e),{},{key:t,onChange:L,value:y[e.name],validityErrors:a||[],displayErrors:!l})):"select"===e.type?Object(c.createElement)(ke,Object(b.a)(Object(b.a)({},e),{},{key:t,onChange:L,value:y[e.name],validityErrors:a||[],displayErrors:!l})):"slider"===e.type?Object(c.createElement)(we,Object(b.a)(Object(b.a)({},e),{},{key:t,onChange:L,value:y[e.name],validityErrors:a||[],displayErrors:!l})):"checkbox"===e.type?Object(c.createElement)(Ce,Object(b.a)(Object(b.a)({},e),{},{key:t,onChange:L,value:y[e.name],validityErrors:a||[],displayErrors:!l})):Object(c.createElement)(Le,Object(b.a)(Object(b.a)({},e),{},{onChange:L,value:y[e.name],validityErrors:a||[],key:t,displayErrors:!l}))})),B=(l&&0!==M.length||0!==h.length)&&Object(a.jsxs)("ul",{className:"form_validity-errors",children:[l&&M.map((function(e,t){return Object(a.jsx)("li",{className:"form_validity-error",children:e},t)})),h.map((function(e,t){return Object(a.jsx)("li",{className:"form_validity-error",children:e},t)}))]}),P=(0!==i.length?i:[{title:n,size:100,columns:s}]).map((function(e,t){var n=R.splice(0,e.size),r={gridTemplateColumns:"1fr ".repeat(e.columns)},l=0!==t?Object(a.jsx)("div",{className:"form_section-delimeter"}):"";return Object(a.jsxs)(c.Fragment,{children:[l,e.title&&Object(a.jsx)("div",{className:"form_title",children:Object(a.jsx)("h2",{children:e.title})}),Object(a.jsx)("div",{className:"form_fields",style:r,children:n})]},t)}));return Object(a.jsxs)("form",{className:"form",style:{width:o},onSubmit:function(e){var n=x.csrftoken?{"X-CSRFToken":x.csrftoken}:{},a=m?{Authorization:"Bearer "+localStorage.getItem("access_token")}:{};(function(){var e=t.filter((function(e){return w[e.name]})).reduce((function(e,t){return C(t.name,y[t.name])&&e}),!0),n=Object.values(V).reduce((function(e,t){return Object.values(t).reduce((function(e,t){return!t[0]&&e}),!0)&&e}),!0);return e&&n})()&&fetch(r,{method:"POST",body:JSON.stringify(Object(b.a)(Object(b.a)({},y),d)),headers:Object(b.a)(Object(b.a)(Object(b.a)({"Content-Type":"application/json"},n),j),a)}).then((function(e){e.json().then((function(t){f(Object(b.a)(Object(b.a)({},y),d),t,e.status,"/"+e.url.split("/").slice(3).join("/")),console.log(e)}))})),e.preventDefault()},noValidate:!0,autoComplete:"off",children:[Object(a.jsxs)("div",{className:"form_body",children:[P,B]}),Object(a.jsx)(ee,{type:"form",submit:!0})]})}Pe.defaultProps={fields:[],columns:1,singleErrorList:!0,formTitle:"",dataToSend:{},headers:{},errorsToDisplay:[],onFieldChange:function(){},sections:[]};var Ie=Pe;n(259),n(260);function De(e){var t=e.name,n=e.label,c=e.value,r=e.unit,l=e.alternativeUnits,s=Object(a.jsx)("div",{className:"data-square_field",children:Number(c).toFixed(r.accuracy)+" "+r.name},-1),i=l.map((function(e,t){return Object(a.jsx)("div",{className:"data-square_field",children:Number(c*e.rate).toFixed(e.accuracy)+" "+e.name},t)}));return Object(a.jsxs)("div",{className:"data-square",children:[Object(a.jsx)("div",{className:"data-square_title",children:n||t}),Object(a.jsx)("div",{className:"data-square_fields",children:[s].concat(Object(j.a)(i))})]})}De.defaultProps={label:"Title",value:6,unit:{name:"kg",accuracy:1},alternativeUnits:[]};var ze=De;function Ue(e){var t=e.input,n=e.result,c=e.model,r="row"===e.layout?" result-section__row":"",l=c.SOURCE_FIELDS.map((function(e,n){var c=e.LABEL||e.NAME,r=e.CATEGORIAL?e.VALUES.find((function(n){return n.NAME===t[e.NAME]})).LABEL||t[e.NAME]:t[e.NAME]+(e.UNIT?" "+e.UNIT:"");return Object(a.jsxs)("div",{className:"result-section_source",children:[Object(a.jsx)("div",{className:"result-section_source-name",children:c}),Object(a.jsx)("div",{className:"result-section_source-value",children:r})]},n)})),s={label:c.LABEL_TO_PREDICT.LABEL||c.LABEL_TO_PREDICT.NAME,name:c.LABEL_TO_PREDICT.NAME,value:n,unit:{name:c.LABEL_TO_PREDICT.UNIT,accuracy:c.LABEL_TO_PREDICT.ACCURACY},alternativeUnits:c.LABEL_TO_PREDICT.ALTERNATIVE_UNITS.map((function(e){return{name:e.UNIT,rate:e.RATE,accuracy:e.ACCURACY}}))};return Object(a.jsxs)("div",{className:"result-section"+r,children:[Object(a.jsxs)("div",{className:"result-section_sources",children:[Object(a.jsx)("div",{className:"result-section_sources-title",children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b"}),l]}),Object(a.jsx)("div",{className:"result-section_results",children:Object(a.jsx)(ze,Object(b.a)({},s))})]})}Ue.defaultProps={layout:"column"};var qe=Ue,Ze=(n(261),n(195));function Fe(e){var t=e.model,n=[];t&&t.PREDICTED_VALUES.forEach((function(e,a){n.push({x:e,y:t.TRUE_VALUES[a]})}));var c=[{id:"\u041f\u041e\u041e",data:n}],r=Object(a.jsxs)("table",{children:[Object(a.jsxs)("tr",{children:[Object(a.jsx)("th",{children:"\u041c\u0435\u0442\u0440\u0438\u043a\u0430"}),Object(a.jsx)("th",{children:"\u0417\u043d\u0430\u0447\u0435\u043d\u0438\u0435"})]}),t.TEST_METRICS.map((function(e){return Object(a.jsxs)("tr",{children:[Object(a.jsx)("td",{children:e.FULL_LABEL}),Object(a.jsx)("td",{children:e.VALUE.toFixed(4)})]})}))]});return Object(a.jsxs)("div",{className:"model-info-section",children:[Object(a.jsx)("div",{className:"model-info-section_plot",children:Object(a.jsx)(Ze.a,{data:c,margin:{top:40,right:60,bottom:40,left:60},xScale:{type:"linear",min:0,max:12.055},xFormat:function(e){return e.toFixed(3)+" \u041c\u0414\u0436/\u0441\u0443\u0442"},yScale:{type:"linear",min:0,max:12.055},yFormat:function(e){return e.toFixed(3)+" \u041c\u0414\u0436/\u0441\u0443\u0442"},nodeSize:2,colors:"#A4145A",axisTop:null,axisRight:null,axisBottom:{orient:"bottom",tickSize:5,tickPadding:5,tickRotation:0,legend:"\u041f\u0440\u0435\u0434\u0441\u043a\u0430\u0437\u0430\u043d\u043d\u044b\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f",legendPosition:"middle",legendOffset:35},axisLeft:{orient:"left",tickSize:5,tickPadding:5,tickRotation:0,legend:"\u0424\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u0437\u043d\u0430\u0447\u0435\u043d\u0438\u044f",legendPosition:"middle",legendOffset:-35}})}),r]})}Fe.defaultProps={};var Ge=Fe,We=function(e){return e.SOURCE_FIELDS.map((function(e){return e.CATEGORIAL?{name:e.NAME,label:e.LABEL||e.NAME,type:"radio",options:e.VALUES.map((function(e){return Object.fromEntries(Object.entries(e).map((function(e){var t=Object(u.a)(e,2),n=t[0],a=t[1];return[n.toLowerCase(),a]})))})),initialValue:e.DEFAULT_VALUE}:{name:e.NAME,label:(e.LABEL||e.NAME)+(e.UNIT?" (".concat(e.UNIT,")"):""),type:"text",regex:"^-?([0-9]+([.][0-9]*)?|[.][0-9]+)$",required:!0,maxLength:5,placeholder:e.DEFAULT_VALUE}}))};function Je(e){var t=e.model,n=e.request,c=e.result,r=e.onResponse;if(!t)return Object(a.jsx)(d.a,{to:"/models"});var l={MODEL_NAME:t.MODEL_NAME},s=Object(a.jsx)(Ie,{fields:We(t),columns:2,dataToSend:l,submitUrl:"/api/predict/",formTitle:t.MODEL_TITLE||t.MODEL_NAME,onResponse:function(e,n){Object.keys(l).forEach((function(t){delete e[t]})),r(t.MODEL_NAME,e,+n)}}),i=c&&n&&Object(a.jsx)(X,{title:"\u0420\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u044b",children:Object(a.jsx)(qe,{input:n,model:t,result:c,layout:"col"})});return Object(a.jsxs)("div",{className:"model",children:[Object(a.jsxs)(X,{width:"500px",className:"model-info-window",children:[Object(a.jsx)(Ge,{model:t})," "]}),Object(a.jsx)(X,{blank:!0,width:"420px",children:s}),i]})}Je.defaultProps={};var Ye=Je;function Ke(e){var t=e.models,n=Object(c.useState)({}),r=Object(u.a)(n,2),l=r[0],s=r[1],i=Object(c.useState)({}),o=Object(u.a)(i,2),j=o[0],m=o[1],f=Object(d.h)().modelName,h=t.find((function(e){return e.MODEL_NAME===f}));return Object(c.useEffect)((function(){console.log("Model rerender")}),[h]),h?Object(a.jsx)(Ye,{model:h,result:l[f],request:j[f],onResponse:function(e,t,n){m((function(n){return Object(b.a)(Object(b.a)({},n),{},Object(ge.a)({},e,t))})),s((function(t){return Object(b.a)(Object(b.a)({},t),{},Object(ge.a)({},e,n))}))}}):Object(a.jsx)(d.a,{to:"/models"})}Ke.defaultProps={};var Xe=Ke;n(396);function $e(e){e.name;var t=e.title,n=e.description,c=e.to,r=e.exact;return Object(a.jsxs)(i.c,{to:c,activeClassName:"model-link__active",className:"model-link",exact:r,children:[Object(a.jsx)("div",{className:"model-link_name",children:t}),Object(a.jsx)("div",{className:"model-link_description",children:n})]})}$e.defaultProps={exact:!1};var Qe=$e;function et(){var e=Object(c.useState)(null),t=Object(u.a)(e,2),n=t[0],r=t[1];Object(c.useEffect)((function(){fetch("/api/get_models/").then((function(e){return e.json()})).then((function(e){r(e)})).catch((function(e){return console.error("ERROR: ",e)}))}),[]);var l=n&&n.map((function(e,t){return Object(a.jsx)(Qe,{name:e.MODEL_NAME,title:e.MODEL_TITLE||e.MODEL_NAME,description:e.MODEL_DESCRIPTION,to:"/models/"+e.MODEL_NAME},t)}));return Object(a.jsxs)("div",{className:"models-page",children:[Object(a.jsx)("div",{className:"models-page_navbar",children:Object(a.jsx)(p,{title:"\u041c\u043e\u0434\u0435\u043b\u0438",size:"350px",fontSize:"24px",children:l})}),Object(a.jsx)("div",{className:"models-page_main-area",children:Object(a.jsxs)(d.d,{children:[Object(a.jsx)(d.b,{exact:!0,path:"/models"}),Object(a.jsx)(d.b,{path:"/models/:modelName",children:n&&Object(a.jsx)(Xe,{models:n})})]})})]})}et.defaultProps={};var tt=et;n(397),n(398);function nt(e){var t=e.form,n=e.username,r=e.onSuccess,l=Object(c.useState)([]),s=Object(u.a)(l,2),i=s[0],o=s[1],d=Object(c.useState)(null),j=Object(u.a)(d,2),m=j[0],f=j[1];Object(c.useEffect)((function(){var e=n||localStorage.getItem("username")||null;f(e?t.map((function(t){return"username"===t.name?Object(b.a)(Object(b.a)({},t),{},{initialValue:e}):t})):t)}),[]);var h=m?Object(a.jsx)(Ie,{columns:1,singleErrorList:!1,submitUrl:"/api/auth/get_token/",fields:m,formTitle:"\u0412\u043e\u0439\u0442\u0438 \u0432 \u0430\u043a\u043a\u0430\u0443\u043d\u0442",onResponse:function(e,t,n){200===n?(o([]),r(t,e.username)):o([{errID:n,error:Be[n]}])},errorsToDisplay:i.map((function(e){return e.error})),onFieldChange:function(){return o([])}}):"";return Object(a.jsx)("div",{className:"login",children:h})}nt.defaultProps={username:null};var at=nt;n(399);function ct(e){var t=e.form,n=e.onSuccess,r=Object(c.useState)([]),l=Object(u.a)(r,2),s=l[0],i=l[1],o=t?Object(a.jsx)(Ie,{columns:1,singleErrorList:!1,submitUrl:"/api/auth/create/",fields:t,formTitle:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f",onResponse:function(e,t,a){t.username?(i([]),n(t.username)):i(t)},errorsToDisplay:s.map((function(e){return e.error})),onFieldChange:function(){return i([])}}):"";return Object(a.jsx)("div",{className:"register",children:o})}ct.defaultProps={};var rt=ct;function lt(e){var t=e.onAuth,n=Object(c.useState)(null),r=Object(u.a)(n,2),l=r[0],s=r[1],i=Object(c.useState)("login"),o=Object(u.a)(i,2),d=o[0],j=o[1],b=Object(c.useState)(null),m=Object(u.a)(b,2),f=m[0],h=m[1];Object(c.useEffect)((function(){fetch("/api/get_forms/?forms=register,login").then((function(e){return e.json()})).then((function(e){s(e)})).catch((function(e){return console.error("ERROR: ",e)}))}),[]);var p=l&&Object(a.jsx)(at,{onSuccess:function(e,n){je(e),localStorage.setItem("username",n),t(!0)},username:f,form:l.login}),O=l&&Object(a.jsx)(rt,{onSuccess:function(e){h(e),j("login")},form:l.register}),v="login"===d?Object(a.jsxs)(X,{width:"500px",title:"\u041d\u043e\u0432\u044b\u0439 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044c?",style:{marginBottom:"15px"},children:["\u041f\u0435\u0440\u0435\u0439\u0442\u0438 \u043a ",Object(a.jsx)("span",{onClick:function(){return j("register")},className:"auth-modal_link",children:"\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"})]}):Object(a.jsxs)(X,{width:"500px",title:"\u0423\u0436\u0435 \u0435\u0441\u0442\u044c \u0430\u043a\u043a\u0430\u0443\u043d\u0442?",style:{marginBottom:"15px"},children:["\u041d\u0430\u0436\u043c\u0438\u0442\u0435 ",Object(a.jsx)("span",{onClick:function(){return j("login")},className:"auth-modal_link",children:"\u0437\u0434\u0435\u0441\u044c"}),", \u0447\u0442\u043e\u0431\u044b \u0432\u043e\u0439\u0442\u0438"]});return Object(a.jsx)("div",{className:"auth-modal_container",children:Object(a.jsxs)("div",{className:"auth-modal",children:[v,Object(a.jsx)(X,{blank:!0,width:"500px",children:"login"===d?p:O})]})})}lt.defaultProps={};var st=lt,it=(n(400),n(401),"/api/get_preferences_page/"),ot=[{label:"\u041f\u0438\u0449. \u0432\u043e\u043b\u043e\u043a\u043d\u0430",value:30,unit:{name:"\u0433",accuracy:.01}},{label:"\u041d\u0416\u041a",value:25,unit:{name:"\u0433",accuracy:.01},sign:"<"},{label:"\u041f\u041d\u0416\u041a",value:11,unit:{name:"\u0433",accuracy:.01},sign:">"},{label:"\u0425\u043e\u043b\u0435\u0441\u0442\u0435\u0440\u0438\u043d",value:300,unit:{name:"\u043c\u0433",accuracy:.01},sign:"<"},{label:"\u041d\u0430\u0442\u0440\u0438\u0439",value:2400,unit:{name:"\u043c\u0433",accuracy:.01},sign:"<"},{label:"\u041a\u0430\u043b\u0438\u0439",value:3500,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u041a\u0430\u043b\u044c\u0446\u0438\u0439",value:1e3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0424\u043e\u0441\u0444\u043e\u0440",value:1e3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0419\u043e\u0434",value:150,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u041c\u0430\u0433\u043d\u0438\u0439",value:400,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0416\u0435\u043b\u0435\u0437\u043e",value:14,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0426\u0438\u043d\u043a",value:9.5,unit:{name:"\u043c\u0433",accuracy:.01}}],ut=[{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d A",value:1,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B1",value:1.5,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B2",value:1.8,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B3",value:20,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B6",value:1.3,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B9",value:400,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d B12",value:2.4,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d C",value:70,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d D",value:15,unit:{name:"\u03bc\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d E",value:10,unit:{name:"\u043c\u0433",accuracy:.01}},{label:"\u0412\u0438\u0442\u0430\u043c\u0438\u043d K",value:120,unit:{name:"\u03bc\u0433",accuracy:.01}}];function dt(e){var t=e.auth,n=e.onAuth,r=e.onPlanRequest,l=Object(c.useState)(null),s=Object(u.a)(l,2),i=s[0],o=s[1],m=Object(c.useState)([]),f=Object(u.a)(m,2),h=f[0],p=f[1],O=Object(c.useState)(!1),v=Object(u.a)(O,2),x=v[0],g=v[1];Object(c.useEffect)((function(){!function(){var e;fetch(it,{headers:(e=localStorage.getItem("access_token"),{Authorization:"Bearer "+e})}).then((function(e){if(!e.ok)throw{status:e.status,data:"Failed to fetch"};return e.json()})).then((function(e){o(e.data),p(e.status)})).catch((function(e){if(401===e.status)return me(null,it,"GET").then((function(e){o(e.data.data),p(e.data.status),console.log("retryRequest successful",e.status,e.data)})).catch((function(e){e.logout&&n(!1),console.error("retryRequest error!",e.status,e.data,e)}))}))}()}),[t]);var _=function(e){var t=i.energy.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{value:e[t.name]})})),n=i.nutrients.map((function(t){return Object(b.a)(Object(b.a)({},t),{},{value:e[t.name]})}));o((function(e){return Object(b.a)(Object(b.a)({},e),{},{energy:t,nutrients:n})})),!h.includes("energy")&&p((function(e){return[].concat(Object(j.a)(e),["energy","nutrients"])}))},y=function(e,t,a,c){401===a?me(e,c).then((function(e){console.log("retryRequest successful",e.status,e.data),e.data.data&&e.data.data.requirements&&_(e.data.data.requirements)})).catch((function(e){e.logout&&n(!1),console.error("retryRequest error!",e.status,e.data,e)})):(console.log("Response!: ",e,t,a),t.data&&t.data.requirements&&_(t.data.requirements))},E=i&&i["phys-params-PAL-goal"]?Object(a.jsx)(Ie,{singleErrorList:!0,submitUrl:"/api/save_user_params/",fields:i["phys-params-PAL-goal"],sections:[{title:"\u0424\u0438\u0437\u0438\u043e\u043b\u043e\u0433\u0438\u0447\u0435\u0441\u043a\u0438\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b",size:4,columns:4},{title:"\u0424\u0438\u0437\u0438\u0447\u0435\u0441\u043a\u0430\u044f \u0430\u043a\u0442\u0438\u0432\u043d\u043e\u0441\u0442\u044c & \u0446\u0435\u043b\u044c",size:2,columns:2}],onResponse:y,withAuth:!0}):"",N=i&&i["food-preferences"]?Object(a.jsx)(Ie,{columns:2,singleErrorList:!0,fields:i["food-preferences"],submitUrl:"/api/user_preferences/",formTitle:"\u041f\u0440\u0435\u0434\u043f\u043e\u0447\u0442\u0435\u043d\u0438\u044f",onResponse:y,withAuth:!0}):"",A=i&&i.energy?i.energy.map((function(e,t){return Object(a.jsx)(ze,Object(b.a)({},e),t)})):"",V=i&&i.nutrients?Object(a.jsx)(le,{fields:i.nutrients}):"";return x?(r(!0),Object(a.jsx)(d.a,{to:"/meal-plan"})):Object(a.jsx)(c.Fragment,{children:Object(a.jsx)("div",{className:"preferences-page",style:t?{}:{filter:"blur(10px)"},children:Object(a.jsx)("div",{className:"preferences-page_main-area",children:Object(a.jsxs)("div",{className:"preferences-page_grid",children:[Object(a.jsx)(X,{blank:!0,width:"600px",className:"preferences-page_phys-params",style:{zIndex:1},children:E}),Object(a.jsx)(X,{blank:!0,width:"600px",className:"preferences-page_food-prefs",children:N}),Object(a.jsx)(X,{blank:!0,width:"610px",className:"nutrients",empty:!h.includes("energy"),emptyText:"\u0417\u0434\u0435\u0441\u044c \u043d\u0438\u0447\u0435\u0433\u043e \u043d\u0435\u0442.\\\u041f\u043e\u0436\u0430\u043b\u0443\u0439\u0441\u0442\u0430, \u0443\u043a\u0430\u0436\u0438\u0442\u0435 \u043f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b.",children:Object(a.jsxs)("div",{className:"nutrients_grid",children:[Object(a.jsx)("div",{className:"nutrients_title",children:Object(a.jsx)("h2",{children:"\u041f\u043e\u0442\u0440\u0435\u0431\u043d\u043e\u0441\u0442\u0438 \u0438 \u0440\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438"})}),Object(a.jsx)("div",{className:"nutrients_energy",children:A}),Object(a.jsx)("div",{className:"nutrients_main-nutrients",children:V}),Object(a.jsx)("div",{className:"nutrients_other-title",children:Object(a.jsx)("h3",{children:"\u041f\u0438\u0442\u0430\u0442\u0435\u043b\u044c\u043d\u044b\u0435 \u0432\u0435\u0449\u0435\u0441\u0442\u0432\u0430"})}),Object(a.jsx)("div",{className:"nutrients_other-nutrients-1",children:Object(a.jsx)(le,{fields:ot})}),Object(a.jsx)("div",{className:"nutrients_other-nutrients-2",children:Object(a.jsx)(le,{fields:ut})}),Object(a.jsx)("div",{className:"nutrients_button",children:Object(a.jsx)(ee,{type:"corner",corner:"bottom-right",text:"\u0420\u0430\u0441\u0441\u0447\u0438\u0442\u0430\u0442\u044c \u0440\u0430\u0446\u0438\u043e\u043d",onClick:function(){return g(!0)}})})]})})]})})})})}dt.defaultProps={};var jt=dt;n(143);var bt=function(){var e=Object(d.g)(),t=Object(c.useState)(null),n=Object(u.a)(t,2),r=n[0],l=n[1],s=Object(c.useState)(!1),o=Object(u.a)(s,2),j=o[0],b=o[1];Object(c.useEffect)((function(){var e=function(){var e=localStorage.getItem("access_token");if(!e)return!1;var t=de(e);return console.log(t),1e3*t.exp-Date.now()>0}();console.log("isAuth",e),e?l(!0):!function(){var e=localStorage.getItem("refresh_token");if(!e)return!1;var t=de(e);return console.log(t),1e3*t.exp-Date.now()>0}()?l(!1):be().then((function(e){console.log("refreshToken: ",e),200===e.status&&l(!0)})).catch((function(e){console.error(e)}))}),[]),Object(c.useEffect)((function(){fetch("/api/closed/",{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer "+localStorage.getItem("access_token")}}).then((function(e){return e.json()})).then((function(e){console.log("closed: ",e)}))}),[]);var m=["/preferences","/preferences/","/meal-plan","/meal-plan/"].includes(e.pathname)&&!r?Object(a.jsx)(st,{onAuth:function(e){return l(e)}}):"";return Object(a.jsxs)("div",{className:"app",children:[Object(a.jsxs)(p,{title:"Nutrition helper",position:"horizontal",size:"70px",zIndex:100,stickToEnd:1,children:[Object(a.jsx)(i.b,{to:"/models",children:"\u041c\u043e\u0434\u0435\u043b\u0438"}),Object(a.jsx)(i.b,{to:"/preferences",children:"\u041f\u0430\u0440\u0430\u043c\u0435\u0442\u0440\u044b"}),Object(a.jsx)(i.b,{to:"/meal-plan",children:"\u041f\u043b\u0430\u043d \u043f\u0438\u0442\u0430\u043d\u0438\u044f"}),Object(a.jsx)("div",{onClick:function(){localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),l(!1)},children:r&&localStorage.getItem("username")||""})]}),Object(a.jsxs)("div",{className:"app_main",children:[Object(a.jsxs)(d.d,{children:[Object(a.jsx)(d.b,{exact:!0,path:"/",render:function(){return Object(a.jsx)(d.a,{to:"/models"})}}),Object(a.jsx)(d.b,{path:"/models",component:tt}),Object(a.jsx)(d.b,{path:"/preferences",render:function(){return Object(a.jsx)(jt,{auth:r,onAuth:function(e){return l(e)},onPlanRequest:function(e){return b(e)}})}}),Object(a.jsx)(d.b,{path:"/meal-plan",render:function(){return Object(a.jsx)(xe,{auth:r,onAuth:function(e){return l(e)},onPlanRequest:function(e){return b(e)},awaitingNewPlan:j})}}),Object(a.jsx)(d.b,{render:function(){return Object(a.jsx)(d.a,{to:"/"})}})]}),m]})]})};s.a.render(Object(a.jsx)(r.a.StrictMode,{children:Object(a.jsx)(o.a,{children:Object(a.jsx)(i.a,{children:Object(a.jsx)(bt,{})})})}),document.getElementById("root"))},62:function(e,t,n){}},[[402,1,2]]]);
//# sourceMappingURL=main.891ca5f9.chunk.js.map